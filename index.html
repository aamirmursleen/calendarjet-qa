<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CalendarJet QA Daily Checklist</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f0f2f5;
      color: #1a1a2e;
      padding: 16px;
      max-width: 900px;
      margin: 0 auto;
    }
    h1 {
      font-size: 1.6rem;
      text-align: center;
      margin-bottom: 4px;
      color: #1a1a2e;
    }
    .subtitle {
      text-align: center;
      color: #666;
      font-size: 0.95rem;
      margin-bottom: 20px;
    }
    .date-bar {
      text-align: center;
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      padding: 10px 16px;
      border-radius: 10px;
      font-weight: 600;
      margin-bottom: 20px;
      font-size: 1rem;
    }
    .progress-bar {
      background: #e0e0e0;
      border-radius: 20px;
      height: 28px;
      margin-bottom: 20px;
      position: relative;
      overflow: hidden;
    }
    .progress-fill {
      background: linear-gradient(90deg, #43e97b, #38f9d7);
      height: 100%;
      border-radius: 20px;
      transition: width 0.5s ease;
      width: 0%;
    }
    .progress-text {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-weight: 700;
      font-size: 0.85rem;
      color: #333;
    }
    .section {
      background: white;
      border-radius: 12px;
      padding: 16px 20px;
      margin-bottom: 16px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    }
    .section-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 12px;
      cursor: pointer;
      user-select: none;
    }
    .section-header h2 {
      font-size: 1.1rem;
      color: #333;
      flex: 1;
    }
    .section-icon {
      font-size: 1.4rem;
    }
    .section-badge {
      background: #eee;
      color: #555;
      padding: 2px 10px;
      border-radius: 12px;
      font-size: 0.8rem;
      font-weight: 600;
    }
    .section-badge.done {
      background: #d4edda;
      color: #155724;
    }
    .task {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      padding: 10px 0;
      border-bottom: 1px solid #f0f0f0;
    }
    .task:last-child { border-bottom: none; }
    .task input[type="checkbox"] {
      width: 20px;
      height: 20px;
      margin-top: 2px;
      accent-color: #667eea;
      cursor: pointer;
      flex-shrink: 0;
    }
    .task-content { flex: 1; }
    .task-title {
      font-weight: 600;
      font-size: 0.95rem;
      margin-bottom: 4px;
    }
    .task-desc {
      font-size: 0.85rem;
      color: #555;
      line-height: 1.5;
    }
    .task.checked .task-title {
      text-decoration: line-through;
      color: #999;
    }
    .task.checked .task-desc {
      color: #bbb;
    }
    .link-row {
      display: flex;
      gap: 8px;
      margin-top: 6px;
      flex-wrap: wrap;
    }
    .link-btn {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      background: #f0f0f5;
      color: #444;
      text-decoration: none;
      padding: 5px 12px;
      border-radius: 8px;
      font-size: 0.82rem;
      font-weight: 500;
      transition: all 0.2s;
    }
    .link-btn:hover {
      background: #667eea;
      color: white;
    }
    .link-btn.custom { border-left: 3px solid #e67e22; }
    .link-btn.standard { border-left: 3px solid #3498db; }
    .link-btn.dashboard { border-left: 3px solid #9b59b6; }
    .client-card {
      background: #fafafa;
      border-radius: 8px;
      padding: 10px 14px;
      margin-bottom: 8px;
    }
    .client-name {
      font-weight: 700;
      font-size: 0.9rem;
      margin-bottom: 6px;
    }
    .steps {
      margin-top: 8px;
      padding-left: 4px;
    }
    .steps li {
      font-size: 0.84rem;
      color: #555;
      margin-bottom: 4px;
      list-style: none;
      padding-left: 20px;
      position: relative;
    }
    .steps li::before {
      content: attr(data-step);
      position: absolute;
      left: 0;
      font-weight: 700;
      color: #667eea;
      font-size: 0.78rem;
    }
    .note {
      background: #fff3cd;
      border-left: 4px solid #ffc107;
      padding: 10px 14px;
      border-radius: 0 8px 8px 0;
      font-size: 0.85rem;
      margin-top: 10px;
    }
    .pass-fail {
      display: flex;
      gap: 8px;
      margin-top: 8px;
    }
    .pass-fail button {
      padding: 4px 14px;
      border-radius: 6px;
      border: none;
      font-weight: 600;
      font-size: 0.82rem;
      cursor: pointer;
      transition: all 0.2s;
    }
    .btn-pass { background: #d4edda; color: #155724; }
    .btn-pass:hover, .btn-pass.active { background: #28a745; color: white; }
    .btn-fail { background: #f8d7da; color: #721c24; }
    .btn-fail:hover, .btn-fail.active { background: #dc3545; color: white; }
    .btn-skip { background: #e2e3e5; color: #383d41; }
    .btn-skip:hover, .btn-skip.active { background: #6c757d; color: white; }
    .results-box {
      background: white;
      border-radius: 12px;
      padding: 20px;
      margin-top: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.06);
      display: none;
    }
    .results-box h2 { margin-bottom: 12px; }
    .result-line {
      padding: 6px 0;
      font-size: 0.9rem;
      border-bottom: 1px solid #f0f0f0;
    }
    .copy-btn {
      display: block;
      width: 100%;
      padding: 12px;
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 1rem;
      font-weight: 700;
      cursor: pointer;
      margin-top: 12px;
    }
    .copy-btn:hover { opacity: 0.9; }
    .pdf-btn {
      background: linear-gradient(135deg, #e74c3c, #c0392b);
      margin-top: 8px;
    }
    .reset-btn {
      display: block;
      width: 100%;
      padding: 10px;
      background: #f8d7da;
      color: #721c24;
      border: none;
      border-radius: 10px;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      margin-top: 24px;
    }
    @media (max-width: 600px) {
      body { padding: 10px; }
      h1 { font-size: 1.3rem; }
      .section { padding: 12px 14px; }
    }
  </style>
</head>
<body>

<h1>CalendarJet QA Checklist</h1>
<p class="subtitle">Daily testing guide for Samreen</p>
<div class="date-bar" id="dateBar"></div>

<div class="progress-bar">
  <div class="progress-fill" id="progressFill"></div>
  <div class="progress-text" id="progressText">0 / 0 done</div>
</div>

<!-- SECTION 1: Booking Pages Comparison -->
<div class="section" id="sec-booking">
  <div class="section-header" onclick="toggleSection('sec-booking')">
    <span class="section-icon">1.</span>
    <h2>Compare Booking Pages (3 Clients)</h2>
    <span class="section-badge" id="badge-sec-booking">0/3</span>
  </div>
  <div class="section-body">
    <p style="font-size:0.85rem;color:#666;margin-bottom:12px;">Each client has a custom domain and a standard CalendarJet URL. Both should look and work the same.</p>

    <!-- Client 1 -->
    <div class="client-card">
      <div class="client-name">Shaun (Mediamatic)</div>
      <div class="link-row">
        <a class="link-btn custom" href="https://booking.mediamatic.mt" target="_blank">Custom Domain</a>
        <a class="link-btn standard" href="https://www.calendarjet.com/mediamatic" target="_blank">Standard URL</a>
      </div>
      <div class="task" data-section="sec-booking">
        <input type="checkbox" onchange="updateProgress()">
        <div class="task-content">
          <div class="task-title">Compare Shaun's pages</div>
          <ol class="steps">
            <li data-step="1.">Open BOTH links above in 2 tabs</li>
            <li data-step="2.">Click tomorrow's date on both pages</li>
            <li data-step="3.">Check time slots match on both</li>
            <li data-step="4.">Check logo and colors look right on custom domain</li>
          </ol>
          <div class="pass-fail">
            <button class="btn-pass" onclick="setResult(this,'pass')">Pass</button>
            <button class="btn-fail" onclick="setResult(this,'fail')">Fail</button>
            <button class="btn-skip" onclick="setResult(this,'skip')">Skip</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Client 2 -->
    <div class="client-card">
      <div class="client-name">Tony (Port City Pixel)</div>
      <div class="link-row">
        <a class="link-btn custom" href="https://booking.portcitypixel.com" target="_blank">Custom Domain</a>
        <a class="link-btn standard" href="https://www.calendarjet.com/tonyshaw" target="_blank">Standard URL</a>
      </div>
      <div class="task" data-section="sec-booking">
        <input type="checkbox" onchange="updateProgress()">
        <div class="task-content">
          <div class="task-title">Compare Tony's pages</div>
          <ol class="steps">
            <li data-step="1.">Open BOTH links above in 2 tabs</li>
            <li data-step="2.">Click tomorrow's date on both pages</li>
            <li data-step="3.">Check time slots match on both</li>
            <li data-step="4.">Check logo and colors look right on custom domain</li>
          </ol>
          <div class="pass-fail">
            <button class="btn-pass" onclick="setResult(this,'pass')">Pass</button>
            <button class="btn-fail" onclick="setResult(this,'fail')">Fail</button>
            <button class="btn-skip" onclick="setResult(this,'skip')">Skip</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Client 3 -->
    <div class="client-card">
      <div class="client-name">Hamza (Zblogging)</div>
      <div class="link-row">
        <a class="link-btn custom" href="https://book.zblogging.com" target="_blank">Custom Domain</a>
        <a class="link-btn standard" href="https://www.calendarjet.com/hamza" target="_blank">Standard URL</a>
      </div>
      <div class="task" data-section="sec-booking">
        <input type="checkbox" onchange="updateProgress()">
        <div class="task-content">
          <div class="task-title">Compare Hamza's pages</div>
          <ol class="steps">
            <li data-step="1.">Open BOTH links above in 2 tabs</li>
            <li data-step="2.">Click tomorrow's date on both pages</li>
            <li data-step="3.">Check time slots match on both</li>
            <li data-step="4.">Check logo and colors look right on custom domain</li>
          </ol>
          <div class="pass-fail">
            <button class="btn-pass" onclick="setResult(this,'pass')">Pass</button>
            <button class="btn-fail" onclick="setResult(this,'fail')">Fail</button>
            <button class="btn-skip" onclick="setResult(this,'skip')">Skip</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- SECTION 2: Test a Booking -->
<div class="section" id="sec-testbooking">
  <div class="section-header" onclick="toggleSection('sec-testbooking')">
    <span class="section-icon">2.</span>
    <h2>Test a Booking Submission</h2>
    <span class="section-badge" id="badge-sec-testbooking">0/2</span>
  </div>
  <div class="section-body">
    <p style="font-size:0.85rem;color:#666;margin-bottom:12px;">Pick any ONE client from above. Use their custom domain link.</p>

    <div class="task" data-section="sec-testbooking">
      <input type="checkbox" onchange="updateProgress()">
      <div class="task-content">
        <div class="task-title">Book on Custom Domain</div>
        <ol class="steps">
          <li data-step="1.">Go to any client's custom domain booking page</li>
          <li data-step="2.">Click tomorrow's date</li>
          <li data-step="3.">Pick any available time slot</li>
          <li data-step="4.">Fill in the form: Name = "QA Test", Email = your email</li>
          <li data-step="5.">Click Submit / Book</li>
          <li data-step="6.">You should see a confirmation page saying "Booking confirmed"</li>
          <li data-step="7.">Check your email inbox (look in "Updates" tab, not spam) for confirmation email</li>
          <li data-step="8.">Open the email - check the date and time are correct</li>
        </ol>
        <div class="pass-fail">
          <button class="btn-pass" onclick="setResult(this,'pass')">Pass</button>
          <button class="btn-fail" onclick="setResult(this,'fail')">Fail</button>
          <button class="btn-skip" onclick="setResult(this,'skip')">Skip</button>
        </div>
      </div>
    </div>

    <div class="task" data-section="sec-testbooking">
      <input type="checkbox" onchange="updateProgress()">
      <div class="task-content">
        <div class="task-title">Book on Standard URL</div>
        <ol class="steps">
          <li data-step="1.">Go to the same client's standard CalendarJet URL</li>
          <li data-step="2.">Pick a DIFFERENT time than your first booking</li>
          <li data-step="3.">Fill in form and submit</li>
          <li data-step="4.">Confirm you see the confirmation page</li>
          <li data-step="5.">Check you get a confirmation email</li>
        </ol>
        <div class="pass-fail">
          <button class="btn-pass" onclick="setResult(this,'pass')">Pass</button>
          <button class="btn-fail" onclick="setResult(this,'fail')">Fail</button>
          <button class="btn-skip" onclick="setResult(this,'skip')">Skip</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- SECTION 3: Timezone Matching -->
<div class="section" id="sec-timezone">
  <div class="section-header" onclick="toggleSection('sec-timezone')">
    <span class="section-icon">3.</span>
    <h2>Timezone Matching</h2>
    <span class="section-badge" id="badge-sec-timezone">0/3</span>
  </div>
  <div class="section-body">
    <p style="font-size:0.85rem;color:#666;margin-bottom:12px;">After making a test booking, verify the timezone is consistent everywhere.</p>

    <div class="task" data-section="sec-timezone">
      <input type="checkbox" onchange="updateProgress()">
      <div class="task-content">
        <div class="task-title">Booking page shows correct timezone</div>
        <ol class="steps">
          <li data-step="1.">On the booking page, look for the timezone displayed (usually near the calendar or time slots)</li>
          <li data-step="2.">It should match your device's timezone OR the host's timezone</li>
          <li data-step="3.">Note down what timezone you see</li>
        </ol>
        <div class="pass-fail">
          <button class="btn-pass" onclick="setResult(this,'pass')">Pass</button>
          <button class="btn-fail" onclick="setResult(this,'fail')">Fail</button>
          <button class="btn-skip" onclick="setResult(this,'skip')">Skip</button>
        </div>
      </div>
    </div>

    <div class="task" data-section="sec-timezone">
      <input type="checkbox" onchange="updateProgress()">
      <div class="task-content">
        <div class="task-title">Confirmation email shows correct time</div>
        <ol class="steps">
          <li data-step="1.">Open the confirmation email you received</li>
          <li data-step="2.">Check the time shown matches the time you selected on the booking page</li>
          <li data-step="3.">Check the timezone label is correct</li>
        </ol>
        <div class="pass-fail">
          <button class="btn-pass" onclick="setResult(this,'pass')">Pass</button>
          <button class="btn-fail" onclick="setResult(this,'fail')">Fail</button>
          <button class="btn-skip" onclick="setResult(this,'skip')">Skip</button>
        </div>
      </div>
    </div>

    <div class="task" data-section="sec-timezone">
      <input type="checkbox" onchange="updateProgress()">
      <div class="task-content">
        <div class="task-title">Dashboard shows correct time</div>
        <div class="link-row">
          <a class="link-btn dashboard" href="https://www.calendarjet.com/dashboard" target="_blank">Open Dashboard</a>
        </div>
        <ol class="steps">
          <li data-step="1.">Log into the CalendarJet dashboard</li>
          <li data-step="2.">Find your test booking in the bookings list or calendar view</li>
          <li data-step="3.">Check the date and time match what you booked</li>
        </ol>
        <div class="pass-fail">
          <button class="btn-pass" onclick="setResult(this,'pass')">Pass</button>
          <button class="btn-fail" onclick="setResult(this,'fail')">Fail</button>
          <button class="btn-skip" onclick="setResult(this,'skip')">Skip</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- SECTION 4: Google Calendar Sync -->
<div class="section" id="sec-gcal">
  <div class="section-header" onclick="toggleSection('sec-gcal')">
    <span class="section-icon">4.</span>
    <h2>Google Calendar Sync</h2>
    <span class="section-badge" id="badge-sec-gcal">0/2</span>
  </div>
  <div class="section-body">
    <div class="task" data-section="sec-gcal">
      <input type="checkbox" onchange="updateProgress()">
      <div class="task-content">
        <div class="task-title">Booking appears in Google Calendar</div>
        <ol class="steps">
          <li data-step="1.">Open Google Calendar (on phone or computer)</li>
          <li data-step="2.">Go to tomorrow's date</li>
          <li data-step="3.">You should see the test booking you just made</li>
          <li data-step="4.">Check the time matches what you booked</li>
        </ol>
        <div class="pass-fail">
          <button class="btn-pass" onclick="setResult(this,'pass')">Pass</button>
          <button class="btn-fail" onclick="setResult(this,'fail')">Fail</button>
          <button class="btn-skip" onclick="setResult(this,'skip')">Skip</button>
        </div>
      </div>
    </div>

    <div class="task" data-section="sec-gcal">
      <input type="checkbox" onchange="updateProgress()">
      <div class="task-content">
        <div class="task-title">Google Calendar blocks availability</div>
        <ol class="steps">
          <li data-step="1.">In Google Calendar, create a fake event for tomorrow (e.g. 2:00 PM). Save it</li>
          <li data-step="2.">Go back to the booking page, refresh the page</li>
          <li data-step="3.">The 2:00 PM time slot should now be gone / blocked</li>
          <li data-step="4.">Go back to Google Calendar, delete that fake event</li>
          <li data-step="5.">Refresh the booking page - the 2:00 PM slot should come back</li>
        </ol>
        <div class="note">This test confirms two-way calendar sync is working correctly.</div>
        <div class="pass-fail">
          <button class="btn-pass" onclick="setResult(this,'pass')">Pass</button>
          <button class="btn-fail" onclick="setResult(this,'fail')">Fail</button>
          <button class="btn-skip" onclick="setResult(this,'skip')">Skip</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- SECTION 5: AI Agent -->
<div class="section" id="sec-ai">
  <div class="section-header" onclick="toggleSection('sec-ai')">
    <span class="section-icon">5.</span>
    <h2>AI Agent</h2>
    <span class="section-badge" id="badge-sec-ai">0/1</span>
  </div>
  <div class="section-body">
    <div class="task" data-section="sec-ai">
      <input type="checkbox" onchange="updateProgress()">
      <div class="task-content">
        <div class="task-title">AI Chat responds correctly</div>
        <ol class="steps">
          <li data-step="1.">On any booking page, look for a chat bubble icon (bottom-right corner)</li>
          <li data-step="2.">Click it and type: "What time slots are available tomorrow?"</li>
          <li data-step="3.">It should give you a real answer with actual times, not an error message</li>
          <li data-step="4.">Try another question: "Can I book for 30 minutes?"</li>
          <li data-step="5.">Verify you get a helpful response</li>
        </ol>
        <div class="pass-fail">
          <button class="btn-pass" onclick="setResult(this,'pass')">Pass</button>
          <button class="btn-fail" onclick="setResult(this,'fail')">Fail</button>
          <button class="btn-skip" onclick="setResult(this,'skip')">Skip</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- SECTION 6: Branding / Customizer -->
<div class="section" id="sec-brand">
  <div class="section-header" onclick="toggleSection('sec-brand')">
    <span class="section-icon">6.</span>
    <h2>Branding & Customizer Match</h2>
    <span class="section-badge" id="badge-sec-brand">0/2</span>
  </div>
  <div class="section-body">
    <div class="task" data-section="sec-brand">
      <input type="checkbox" onchange="updateProgress()">
      <div class="task-content">
        <div class="task-title">Profile page changes reflect on booking page</div>
        <div class="link-row">
          <a class="link-btn dashboard" href="https://www.calendarjet.com/dashboard" target="_blank">Dashboard</a>
        </div>
        <ol class="steps">
          <li data-step="1.">Go to Dashboard > Profile settings</li>
          <li data-step="2.">Note the name, bio, and profile image</li>
          <li data-step="3.">Open the booking page for the same user</li>
          <li data-step="4.">Verify the name, bio, and image match what's in the profile</li>
        </ol>
        <div class="pass-fail">
          <button class="btn-pass" onclick="setResult(this,'pass')">Pass</button>
          <button class="btn-fail" onclick="setResult(this,'fail')">Fail</button>
          <button class="btn-skip" onclick="setResult(this,'skip')">Skip</button>
        </div>
      </div>
    </div>

    <div class="task" data-section="sec-brand">
      <input type="checkbox" onchange="updateProgress()">
      <div class="task-content">
        <div class="task-title">Booking page customizer changes appear</div>
        <div class="link-row">
          <a class="link-btn dashboard" href="https://www.calendarjet.com/branding" target="_blank">Branding Page</a>
        </div>
        <ol class="steps">
          <li data-step="1.">Go to Dashboard > Branding / Booking Page Customizer</li>
          <li data-step="2.">Note the logo, colors, button styles, and layout settings</li>
          <li data-step="3.">Open the booking page (both custom domain and standard URL)</li>
          <li data-step="4.">Verify the logo, colors, and layout match the customizer settings</li>
        </ol>
        <div class="pass-fail">
          <button class="btn-pass" onclick="setResult(this,'pass')">Pass</button>
          <button class="btn-fail" onclick="setResult(this,'fail')">Fail</button>
          <button class="btn-skip" onclick="setResult(this,'skip')">Skip</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- SECTION 7: Support Ticket -->
<div class="section" id="sec-support">
  <div class="section-header" onclick="toggleSection('sec-support')">
    <span class="section-icon">7.</span>
    <h2>Support Ticket Submission</h2>
    <span class="section-badge" id="badge-sec-support">0/1</span>
  </div>
  <div class="section-body">
    <div class="task" data-section="sec-support">
      <input type="checkbox" onchange="updateProgress()">
      <div class="task-content">
        <div class="task-title">Submit a test support ticket</div>
        <div class="link-row">
          <a class="link-btn standard" href="https://www.calendarjet.com/support" target="_blank">Support Page</a>
          <a class="link-btn standard" href="https://www.calendarjet.com/contact" target="_blank">Contact Page</a>
        </div>
        <ol class="steps">
          <li data-step="1.">Go to the Support or Contact page</li>
          <li data-step="2.">Subject: [QA-TEST] Daily check</li>
          <li data-step="3.">Write any message and submit</li>
          <li data-step="4.">You should see a success message</li>
          <li data-step="5.">It should appear in Jira within 1 hour (the team can confirm)</li>
        </ol>
        <div class="pass-fail">
          <button class="btn-pass" onclick="setResult(this,'pass')">Pass</button>
          <button class="btn-fail" onclick="setResult(this,'fail')">Fail</button>
          <button class="btn-skip" onclick="setResult(this,'skip')">Skip</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Results Summary -->
<div class="results-box" id="resultsBox">
  <h2>Today's QA Summary</h2>
  <div id="resultsList"></div>
  <button class="copy-btn" onclick="copyResults()">Copy Summary to Clipboard</button>
  <button class="copy-btn pdf-btn" onclick="downloadPDF()">Download PDF Report</button>
</div>

<button class="copy-btn pdf-btn" onclick="downloadPDF()" style="margin-bottom:10px;">Download PDF Report</button>
<button class="reset-btn" onclick="resetAll()">Reset All Checkboxes</button>

<script>
  // Date
  const now = new Date();
  const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
  document.getElementById('dateBar').textContent = now.toLocaleDateString('en-US', options);

  // Storage key based on date
  const storageKey = 'qa-' + now.toISOString().slice(0, 10);

  // Load saved state
  function loadState() {
    try {
      const saved = JSON.parse(localStorage.getItem(storageKey) || '{}');
      const checkboxes = document.querySelectorAll('.task input[type="checkbox"]');
      checkboxes.forEach((cb, i) => {
        if (saved.checks && saved.checks[i]) {
          cb.checked = true;
          cb.closest('.task').classList.add('checked');
        }
      });
      if (saved.results) {
        document.querySelectorAll('.pass-fail').forEach((pf, i) => {
          if (saved.results[i]) {
            const btn = pf.querySelector(`.btn-${saved.results[i]}`);
            if (btn) btn.classList.add('active');
          }
        });
      }
      updateProgress();
    } catch(e) {}
  }

  function saveState() {
    const checks = [];
    document.querySelectorAll('.task input[type="checkbox"]').forEach(cb => {
      checks.push(cb.checked);
    });
    const results = [];
    document.querySelectorAll('.pass-fail').forEach(pf => {
      if (pf.querySelector('.btn-pass.active')) results.push('pass');
      else if (pf.querySelector('.btn-fail.active')) results.push('fail');
      else if (pf.querySelector('.btn-skip.active')) results.push('skip');
      else results.push(null);
    });
    localStorage.setItem(storageKey, JSON.stringify({ checks, results }));
  }

  function updateProgress() {
    const all = document.querySelectorAll('.task input[type="checkbox"]');
    const checked = document.querySelectorAll('.task input[type="checkbox"]:checked');
    const pct = all.length ? Math.round((checked.length / all.length) * 100) : 0;
    document.getElementById('progressFill').style.width = pct + '%';
    document.getElementById('progressText').textContent = `${checked.length} / ${all.length} done (${pct}%)`;

    // Update section badges
    const sections = ['sec-booking', 'sec-testbooking', 'sec-timezone', 'sec-gcal', 'sec-ai', 'sec-brand', 'sec-support'];
    sections.forEach(sec => {
      const tasks = document.querySelectorAll(`#${sec} .task input[type="checkbox"]`);
      const done = document.querySelectorAll(`#${sec} .task input[type="checkbox"]:checked`);
      const badge = document.getElementById(`badge-${sec}`);
      if (badge) {
        badge.textContent = `${done.length}/${tasks.length}`;
        badge.classList.toggle('done', done.length === tasks.length && tasks.length > 0);
      }
    });

    // Update checked visual
    all.forEach(cb => {
      cb.closest('.task').classList.toggle('checked', cb.checked);
    });

    saveState();
    updateResultsBox();
  }

  function setResult(btn, type) {
    const pf = btn.closest('.pass-fail');
    pf.querySelectorAll('button').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    // Auto-check the checkbox
    const task = btn.closest('.task');
    const cb = task.querySelector('input[type="checkbox"]');
    if (cb && !cb.checked) {
      cb.checked = true;
    }
    updateProgress();
  }

  function toggleSection(id) {
    const body = document.querySelector(`#${id} .section-body`);
    body.style.display = body.style.display === 'none' ? 'block' : 'block';
  }

  function updateResultsBox() {
    const all = document.querySelectorAll('.task input[type="checkbox"]');
    const checked = document.querySelectorAll('.task input[type="checkbox"]:checked');
    if (checked.length === 0) {
      document.getElementById('resultsBox').style.display = 'none';
      return;
    }
    document.getElementById('resultsBox').style.display = 'block';
    let html = '';
    document.querySelectorAll('.task').forEach(task => {
      const title = task.querySelector('.task-title')?.textContent || '';
      const pf = task.querySelector('.pass-fail');
      let status = 'Not tested';
      if (pf) {
        if (pf.querySelector('.btn-pass.active')) status = 'PASS';
        else if (pf.querySelector('.btn-fail.active')) status = 'FAIL';
        else if (pf.querySelector('.btn-skip.active')) status = 'SKIP';
      }
      const icon = status === 'PASS' ? '&#9989;' : status === 'FAIL' ? '&#10060;' : status === 'SKIP' ? '&#9898;' : '&#11035;';
      html += `<div class="result-line">${icon} ${title} &mdash; ${status}</div>`;
    });
    document.getElementById('resultsList').innerHTML = html;
  }

  function copyResults() {
    const dateStr = now.toLocaleDateString('en-US', options);
    let text = `CalendarJet QA Report - ${dateStr}\n${'='.repeat(40)}\n\n`;
    document.querySelectorAll('.task').forEach(task => {
      const title = task.querySelector('.task-title')?.textContent || '';
      const pf = task.querySelector('.pass-fail');
      let status = 'Not tested';
      if (pf) {
        if (pf.querySelector('.btn-pass.active')) status = 'PASS';
        else if (pf.querySelector('.btn-fail.active')) status = 'FAIL';
        else if (pf.querySelector('.btn-skip.active')) status = 'SKIP';
      }
      const icon = status === 'PASS' ? '+' : status === 'FAIL' ? 'X' : status === 'SKIP' ? '-' : '?';
      text += `[${icon}] ${title} - ${status}\n`;
    });
    const all = document.querySelectorAll('.task input[type="checkbox"]');
    const checked = document.querySelectorAll('.task input[type="checkbox"]:checked');
    const fails = document.querySelectorAll('.btn-fail.active').length;
    text += `\nTotal: ${checked.length}/${all.length} tested | ${fails} failures\n`;
    navigator.clipboard.writeText(text).then(() => {
      const btn = document.querySelector('.copy-btn');
      btn.textContent = 'Copied!';
      setTimeout(() => btn.textContent = 'Copy Summary to Clipboard', 2000);
    });
  }

  function resetAll() {
    if (!confirm('Reset all checkboxes and results for today?')) return;
    localStorage.removeItem(storageKey);
    document.querySelectorAll('.task input[type="checkbox"]').forEach(cb => cb.checked = false);
    document.querySelectorAll('.pass-fail button').forEach(b => b.classList.remove('active'));
    updateProgress();
  }

  function downloadPDF() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    const dateStr = now.toLocaleDateString('en-US', options);
    const all = document.querySelectorAll('.task input[type="checkbox"]');
    const checked = document.querySelectorAll('.task input[type="checkbox"]:checked');
    const passes = document.querySelectorAll('.btn-pass.active').length;
    const fails = document.querySelectorAll('.btn-fail.active').length;
    const skips = document.querySelectorAll('.btn-skip.active').length;

    // Header
    doc.setFillColor(102, 126, 234);
    doc.rect(0, 0, 210, 40, 'F');
    doc.setTextColor(255, 255, 255);
    doc.setFontSize(22);
    doc.setFont('helvetica', 'bold');
    doc.text('CalendarJet QA Report', 105, 18, { align: 'center' });
    doc.setFontSize(12);
    doc.setFont('helvetica', 'normal');
    doc.text(dateStr, 105, 30, { align: 'center' });

    // Summary box
    let y = 50;
    doc.setTextColor(50, 50, 50);
    doc.setFontSize(14);
    doc.setFont('helvetica', 'bold');
    doc.text('Summary', 14, y);
    y += 8;
    doc.setFontSize(11);
    doc.setFont('helvetica', 'normal');
    doc.text(`Tested: ${checked.length} / ${all.length}`, 14, y);
    y += 6;

    doc.setTextColor(40, 167, 69);
    doc.text(`Passed: ${passes}`, 14, y);
    doc.setTextColor(220, 53, 69);
    doc.text(`Failed: ${fails}`, 60, y);
    doc.setTextColor(108, 117, 125);
    doc.text(`Skipped: ${skips}`, 106, y);
    y += 10;

    // Divider
    doc.setDrawColor(200, 200, 200);
    doc.line(14, y, 196, y);
    y += 8;

    // Section results
    const sectionNames = {
      'sec-booking': 'Compare Booking Pages',
      'sec-testbooking': 'Test Booking Submission',
      'sec-timezone': 'Timezone Matching',
      'sec-gcal': 'Google Calendar Sync',
      'sec-ai': 'AI Agent',
      'sec-brand': 'Branding & Customizer',
      'sec-support': 'Support Ticket'
    };
    const sectionIds = Object.keys(sectionNames);

    doc.setFontSize(14);
    doc.setFont('helvetica', 'bold');
    doc.setTextColor(50, 50, 50);
    doc.text('Detailed Results', 14, y);
    y += 8;

    sectionIds.forEach(secId => {
      const tasks = document.querySelectorAll(`#${secId} .task`);
      if (tasks.length === 0) return;

      // Check if we need a new page
      if (y > 260) { doc.addPage(); y = 20; }

      doc.setFontSize(11);
      doc.setFont('helvetica', 'bold');
      doc.setTextColor(102, 126, 234);
      doc.text(sectionNames[secId], 14, y);
      y += 6;

      tasks.forEach(task => {
        if (y > 275) { doc.addPage(); y = 20; }

        const title = task.querySelector('.task-title')?.textContent || '';
        const pf = task.querySelector('.pass-fail');
        let status = 'NOT TESTED';
        let color = [150, 150, 150];
        if (pf) {
          if (pf.querySelector('.btn-pass.active')) { status = 'PASS'; color = [40, 167, 69]; }
          else if (pf.querySelector('.btn-fail.active')) { status = 'FAIL'; color = [220, 53, 69]; }
          else if (pf.querySelector('.btn-skip.active')) { status = 'SKIP'; color = [108, 117, 125]; }
        }

        // Status badge
        doc.setFillColor(...color);
        doc.roundedRect(14, y - 4, 18, 6, 1, 1, 'F');
        doc.setTextColor(255, 255, 255);
        doc.setFontSize(7);
        doc.setFont('helvetica', 'bold');
        doc.text(status, 23, y, { align: 'center' });

        // Task title
        doc.setTextColor(50, 50, 50);
        doc.setFontSize(10);
        doc.setFont('helvetica', 'normal');
        doc.text(title, 36, y);
        y += 7;
      });
      y += 3;
    });

    // Footer
    if (y > 270) { doc.addPage(); y = 20; }
    y += 5;
    doc.setDrawColor(200, 200, 200);
    doc.line(14, y, 196, y);
    y += 8;
    doc.setFontSize(9);
    doc.setTextColor(150, 150, 150);
    doc.text('Generated from CalendarJet QA Checklist', 105, y, { align: 'center' });
    y += 5;
    doc.text(`Tester: Samreen | ${dateStr}`, 105, y, { align: 'center' });

    // Download
    const fileName = `CalendarJet-QA-${now.toISOString().slice(0,10)}.pdf`;
    doc.save(fileName);
  }

  // Init
  loadState();
</script>
</body>
</html>
